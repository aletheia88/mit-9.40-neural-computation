## synaptic dynamics (lecture 10 & 11)

### how synapse transmits neural signals
Upon arrival of Action Potential (AP) to the presynaptic terminal, $Ca^{2+}$ voltage-gated channels open up and let in calcium. This leads to neurotransmitter-carrying vesicles to fuse with the membrane, then releasing the neurotransmitters into the synaptic cleft. Through diffusion, the neurotransmitters bind at the postsynaptic terminal; this whole process happens in about $50 \ \mu s$. The binding causes ion channels to open and graded postpotentials to form. Depending on the type of neurotransmitters, these postpotentials can be inhibitory or excitatory. Different neurotransmitters activate different ion channels, leading to either depolarization (often means "excites") or hyperpolarization of the cell (often means "inhibits").

### the Dirac delta function

It is defined as follows
$$
\begin{align*}
\delta (x - x_0) &\equiv \begin{cases}
                  \infty &\text{if} \,\,\, x = x_0 \\
                  0      &\text{if} \,\,\, x \neq x_0
                  \end{cases}\end{align*}
$$
$$
\begin{align*}
\int_{-\infty}^{\infty} \mathrm{d}x \, f(x) \delta(x - x_0) &= f(x_0) \quad\quad\quad\quad
\end{align*}
$$
and note that
$$
\begin{align*}
\int_{-\infty}^{\infty} dx \delta_{\epsilon}(x) = 1
\end{align*}
$$

Let $V$ be some voltage of a cell injected by some pulses of current $I$ at a given instant in times. The dynamics of the cell is represented as follows
$$\tau \frac{dV}{dt} = -V + v_0\tau \sum_{t_s}\delta(t - t_s)$$
where $t_s$ represents the time there is a spike of magnitude $v_0\tau$ applied to the cell.

Integrating over time on both sides yields
$$\tau \int_t^{t+ \Delta t} \frac{d V(t')}{d t'} dt' = -\int_t^{t+ \Delta t} V(t') dt' + v_0 \tau \sum_{t_s} \int_t^{t + \Delta t} \delta(t' - t_s) dt'$$

This becomes $$\tau (V(t+ \Delta t) - V(t)) \approx - V(t)\Delta t + v_0 \tau n(t)$$
where $n(t)$ is the number of $t_s$'s that are between $t$ and $t + \Delta t$.

We can rewrite this into
$$V(t + \Delta t) = (1 - \frac{\Delta t}{\tau}) V(t) + v_0 \tau n(t)$$

### modified LIF model

#### synaptic currents
Synaptic currents are driven by the difference between $E_{syn}$--the equilibrium potential of the synapse--and $V$, the membrane potential of the cell. Specifically, the synaptic current $I_{syn}$ follows

$$I_{syn} = G_{syn} (V - E_{syn})$$

If $V> E_{syn}$ then $I_{syn}>0$, and  if $V< E_{syn}$ then $I_{syn}<0$.

#### LIF neuron with synaptic currents

Troy and Miller (1997) presented a modified LIF model where they consider that the irregularities in spiking are mainly the results of fluctuations due to synaptic currents.

The dynamics of the postsynaptic terminal is governed by

$$\frac{dg_s}{dt} = -\frac{1}{\tau_s}g_s + \bar{g_s} \sum_{j} \delta(t - t_j)$$

where $\bar{g_s}$ is the maximum conductance generated by a presyanptic spike.

Integrating over timem on both sides gives us a numerically-solvable equation (implemented in `scripts/synaptic_dynamics.py/simulate_membrane_potential`):
$$dg_s = -\frac{dt}{\tau_s} g_s + \bar{g_s} \sum_{j} \delta(t - t_j)$$

The post-synaptic current is equal to

$$I_s = g_s (t) (V - E_s)$$

Now, including the dynamics of postsynaptic conductance, the resulting membrane voltage follows
$$C_m \frac{d V}{dt} = - g_L (V - E_L) - g_s (V - E_s) + I_{ext}$$

To include both excitatory and inhibitory conductances, we can expand the above equation into
$$C_m \frac{dV}{dt} = -g_L(V - E_L) - g_{\text{exc}} (V - E_{\text{exc}}) - g_{\text{inh}} (V - E_{\text{inh}}) + I_{\text{ext}}$$

Diving both sides by $g_L$, we will solve for
$$\frac{C_m}{g_L} \frac{dV}{dt} = -(V - E_L) - \frac{g_{\text{exc}}}{g_L} (V - E_{\text{exc}}) - \frac{g_{\text{inh}}}{g_L}(V - E_{\text{exc}}) + \frac{I_{\text{ext}}}{g_L}$$

Note that $\frac{C_m}{g_L} = \tau_m$, that is the membrane time constant.

Therefore, the final equation to be numerically solved is written as
$$\frac{dV}{dt} = \frac{1}{\tau_m} \cdot \left[ (-(V - E_L)) - \frac{g_{\text{exc}}}{g_L} (V - E_{\text{exc}}) - \frac{g_{\text{inh}}}{g_L}(V - E_{\text{exc}}) + \frac{I_{\text{ext}}}{g_L} \right]$$

See its solution in `scripts/synaptic_dynamics.py/simulate_membrane_potential`

## kernel
When we say "kernel", we mean a function that maps the post-synaptic voltage response of a neuron (or neuron ensembles) to a single spike (or a spike train or some other kinds of stimulus). For example, we may have $$K(t) = e^{-t\tau}$$ where $\tau = 10 \ ms$. Suppose that this neuron receives a burst of three presynaptic spikes with a firing rate of $200 \ Hz$